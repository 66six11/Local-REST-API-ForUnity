/// <summary>
/// 处理 {{CONTROLLER_FULL_NAME}}.{{METHOD_NAME}} API请求
/// </summary>
public class {{HANDLER_CLASS_NAME}} : IApiHandler
{
    public bool HandleRequest(HttpListenerRequest request, HttpListenerResponse response)
    {
        try
        {
            // 使用预生成的参数解析器
            var parser = new PredefinedApiHandlers.{{PARAMETER_PARSER_CLASS_NAME}}();
            var parameters = parser.ParseParameters(request);

            // 直接创建控制器实例并调用方法
            var controller = new {{CONTROLLER_FULL_NAME}}();
            var result = controller.{{METHOD_NAME}}({{PARAMETER_CAST_LIST}});

            // 生成JSON响应（使用可序列化的响应类型，避免匿名类型）
            string jsonResponse = result != null 
                ? UnityEngine.JsonUtility.ToJson(result) 
                : UnityEngine.JsonUtility.ToJson(new LocalRestAPI.Runtime.BasicSuccessResponse());
            SendJsonResponse(response, jsonResponse, 200);
            return true;
        }
        catch (System.Exception ex)
        {
            SendJsonResponse(response, $"Method execution error: {ex.Message}", 500);
            return false;
        }
    }

    private void SendJsonResponse(HttpListenerResponse response, string content, int statusCode)
    {
        response.StatusCode = statusCode;
        response.ContentType = "application/json";

        byte[] buffer = System.Text.Encoding.UTF8.GetBytes(content ?? "{}");
        response.ContentLength64 = buffer.Length;

        using (var os = response.OutputStream)
        {
            os.Write(buffer, 0, buffer.Length);
        }
    }
}